(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0e7d6c9a"],{2446:function(e,t,a){},2708:function(e,t,a){"use strict";a.d(t,"c",(function(){return n})),a.d(t,"b",(function(){return s})),a.d(t,"a",(function(){return o}));var i=a("c1df"),r=a.n(i),n={filters:{timeFrom:function(e){return e?r()(e).locale("zh-tw").format("llll"):"-"}}},s={filters:{fromNow:function(e){return e?r()(e).fromNow():"-"}}},o={filters:{emptyImage:function(e){return e||"https://via.placeholder.com/350x220/DFDFDF?text=No+Image"}}}},"5aa0":function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement;e._self._c;return e._m(0)},r=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"spinner"},[a("div",{staticClass:"bouncing-loader"},[a("div"),a("div"),a("div")])])}],n={name:"Spinner"},s=n,o=(a("86c7"),a("2877")),l=Object(o["a"])(s,i,r,!1,null,"99d7148a",null);t["a"]=l.exports},"86c7":function(e,t,a){"use strict";var i=a("a462"),r=a.n(i);r.a},a462:function(e,t,a){},b410:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"h-100"},[e.loadingProfile&&e.loadingTags?a("Spinner"):[a("ProfileForm",{attrs:{"initial-profile":e.profile,"initial-tags":e.allTags,"initial-editing":e.editing,"initial-isProcessing":e.isProcessing},on:{"after-edit":e.edit,"after-submit":e.handleSubmit}})],a("MemberNavbarBottom")],2)},r=[],n=(a("b0c0"),a("2909")),s=(a("96cf"),a("1da1")),o=a("5aa0"),l=a("cd5d"),c=a("c16d"),u=a("2fa3"),m={get:function(){return u["a"].get("/member/profile")},put:function(e){return u["a"].put("/member/profile",e)}},p=a("bf8e"),f={name:"MemberProfile",components:{Spinner:o["a"],ProfileForm:c["a"],MemberNavbarBottom:l["a"]},data:function(){return{profile:{account:"",phone:"",name:"",email:"",avatar:"",preferredTags:[]},allTags:[],saveAccount:"",savePhone:"",saveName:"",saveEmail:"",saveAvatar:"",savePreferredTags:[],loadingProfile:!0,loadingTags:!0,isProcessing:!1,editing:!1}},created:function(){this.loadProfile(),this.fetchTags()},methods:{fetchTags:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){var t,a,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,p["a"].get();case 3:if(t=e.sent,a=t.data,i=t.statusText,"OK"===i){e.next=7;break}throw new Error(i);case 7:this.allTags=a,this.loadingTags=!1,e.next=15;break;case 11:e.prev=11,e.t0=e["catch"](0),this.loadingTags=!1,console.log("error",e.t0);case 15:case"end":return e.stop()}}),e,this,[[0,11]])})));function t(){return e.apply(this,arguments)}return t}(),loadProfile:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){var t,a,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,m.get();case 3:if(t=e.sent,a=t.data,i=t.statusText,"OK"===i){e.next=7;break}throw new Error(i);case 7:"error"===a.status?(this.$swal({toast:!0,position:"top",showConfirmButton:!1,timer:3e3,icon:"warning",title:"未找到會員",text:""}),this.loadingProfile=!1):(this.profile.account=a.user.account,this.profile.phone=a.user.phone,this.profile.name=a.user.Profile.name,this.profile.email=a.user.Profile.email,this.profile.avatar=a.user.Profile.avatar,this.profile.preferredTags=a.user.preferredTags,this.saveAccount=a.user.account,this.savePhone=a.user.phone,this.saveName=a.user.Profile.name,this.saveEmail=a.user.Profile.email,this.saveAvatar=a.user.Profile.avatar,this.savePreferredTags=Object(n["a"])(a.user.preferredTags),this.loadingProfile=!1),e.next=14;break;case 10:e.prev=10,e.t0=e["catch"](0),this.loadingProfile=!1,console.log("error",e.t0);case 14:case"end":return e.stop()}}),e,this,[[0,10]])})));function t(){return e.apply(this,arguments)}return t}(),handleSubmit:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){var t,a,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,this.isProcessing=!0,e.next=4,m.put({account:this.profile.account,name:this.profile.name,phone:this.profile.phone,avatar:this.profile.avatar,tags:this.profile.preferredTags,email:this.profile.email});case 4:if(t=e.sent,a=t.data,i=t.statusText,"OK"===i){e.next=8;break}throw new Error(i);case 8:this.$swal({toast:!0,position:"top",showConfirmButton:!1,timer:3e3,icon:"success",title:a.msg}),this.isProcessing=!1,e.next=17;break;case 12:e.prev=12,e.t0=e["catch"](0),this.isProcessing=!1,this.$swal({icon:"warning",title:"註冊失敗，請稍後再試"}),console.log("error",e.t0);case 17:case"end":return e.stop()}}),e,this,[[0,12]])})));function t(){return e.apply(this,arguments)}return t}(),edit:function(){this.editing?(this.profile.account=this.saveAccount,this.profile.phone=this.savePhone,this.profile.name=this.saveName,this.profile.email=this.saveEmail,this.profile.avatar=this.saveAvatar,this.profile.preferredTags=this.savePreferredTags,this.editing=!1):this.editing=!0}}},d=f,g=a("2877"),h=Object(g["a"])(d,i,r,!1,null,null,null);t["default"]=h.exports},b4c4:function(e,t,a){"use strict";var i=a("2446"),r=a.n(i);r.a},bf8e:function(e,t,a){"use strict";a("d3b7"),a("25f0"),a("3ca3"),a("ddb0"),a("2b3d");var i=a("2fa3");t["a"]={search:function(e){var t=new URLSearchParams(e);return i["a"].get("/member/tag?".concat(t.toString()))},get:function(){return i["a"].get("/member/tags")}}},c16d:function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"box-center",staticStyle:{"background-color":"#F0E8DD",height:"100%"}},[a("div",{staticClass:"container border border-secondary",staticStyle:{"max-width":"500px","border-radius":"5%"}},[a("h1",{staticClass:"py-3 text-center"},[e._v("會員資料")]),a("form",{staticClass:"row"},[a("div",{staticClass:"form-group col-12 text-center"},[a("button",{staticClass:"btn btn-primary px-4 py-2",staticStyle:{position:"absolute",right:"0"},attrs:{disabled:e.initialIsProcessing},on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.edit()}}},[e._v(e._s(e.initialEditing?"取消":"編輯"))]),a("img",{staticClass:"user-avatar",attrs:{src:e._f("emptyImage")(e.profile.avatar),width:"150",height:"150"}}),a("input",{directives:[{name:"show",rawName:"v-show",value:e.initialEditing,expression:"initialEditing"}],staticClass:"align-bottom",attrs:{id:"image",type:"file",name:"image",accept:"image/*",disabled:e.initialIsProcessing||!e.initialEditing},on:{change:e.handleFileChange}})]),"member"===this.$store.state.currentUser.role?a("div",{staticClass:"form-label-group mb-3 col-12"},[a("div",{directives:[{name:"show",rawName:"v-show",value:e.initialEditing,expression:"initialEditing"}]},[a("label",[e._v("標籤")]),a("div",{staticClass:"form-inline mb-2"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.tagName,expression:"tagName"}],staticClass:"form-control mr-sm-2",attrs:{type:"text",name:"searchTag",disabled:e.initialIsProcessing,placeholder:"Search Tag name"},domProps:{value:e.tagName},on:{input:function(t){t.target.composing||(e.tagName=t.target.value)}}}),a("button",{staticClass:"btn btn-primary",attrs:{type:"button",disabled:e.initialIsProcessing},on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.searchTag(t)}}},[e._v("搜尋")])]),e._l(e.tagsDisplay,(function(t){return a("button",{key:t.id,staticClass:"btn btn-primary mr-2 mt-2",attrs:{disabled:e.initialIsProcessing},on:{click:function(a){return a.stopPropagation(),a.preventDefault(),e.addTag(t)}}},[e._v(e._s(t.name))])}))],2),a("label",{staticClass:"d-block"},[e._v("偏好標籤")]),e._l(e.profile.preferredTags,(function(t){return a("div",{key:t.id,staticClass:"d-inline-block"},[a("button",{directives:[{name:"show",rawName:"v-show",value:e.initialEditing,expression:"initialEditing"}],staticClass:"btn btn-primary mr-2 mb-2",attrs:{disabled:e.initialIsProcessing},on:{click:function(a){return a.stopPropagation(),a.preventDefault(),e.removeTag(t)}}},[e._v("#"+e._s(t.name))]),a("div",{directives:[{name:"show",rawName:"v-show",value:!e.initialEditing,expression:"!initialEditing"}],staticClass:"badge badge-danger"},[e._v(e._s(t.name))])])}))],2):e._e(),a("div",{staticClass:"form-label-group mb-3 col-sm-6 col-12",class:{"form-group--error":e.$v.profile.name.$error}},[a("label",{attrs:{for:"name"}},[e._v("Name")]),a("input",{directives:[{name:"model",rawName:"v-model",value:e.profile.name,expression:"profile.name"}],staticClass:"form-control",attrs:{disabled:e.initialIsProcessing||!e.initialEditing,maxlength:"20",minlength:"1",id:"name",name:"name",type:"text",placeholder:"name",required:"",autofocus:""},domProps:{value:e.profile.name},on:{input:[function(t){t.target.composing||e.$set(e.profile,"name",t.target.value)},e.$v.profile.name.$touch]}}),e.$v.profile.name.$error?a("small",{staticClass:"text-danger"},[e._v("長度介於 1 - 20")]):e._e()]),a("div",{staticClass:"form-label-group mb-3 col-sm-6 col-12",class:{"form-group--error":e.$v.profile.phone.$error}},[a("label",{attrs:{for:"name"}},[e._v("Phone")]),a("input",{directives:[{name:"model",rawName:"v-model",value:e.profile.phone,expression:"profile.phone"}],staticClass:"form-control",attrs:{disabled:e.initialIsProcessing||!e.initialEditing,maxlength:"15",minlength:"8",id:"phone",name:"phone",type:"number",placeholder:"phone",required:"",autofocus:""},domProps:{value:e.profile.phone},on:{input:[function(t){t.target.composing||e.$set(e.profile,"phone",t.target.value)},e.$v.profile.phone.$touch]}}),e.$v.profile.phone.$error?a("small",{staticClass:"text-danger"},[e._v("長度需為 10")]):e._e()]),a("div",{staticClass:"form-label-group mb-3 col-sm-6 col-12",class:{"form-group--error":e.$v.profile.email.$error&&!e.$v.profile.email.$pending}},[a("label",{attrs:{for:"email"}},[e._v("Email")]),a("input",{directives:[{name:"model",rawName:"v-model",value:e.profile.email,expression:"profile.email"}],staticClass:"form-control",attrs:{disabled:e.initialIsProcessing||!e.initialEditing,id:"email",name:"email",type:"email",placeholder:"email",required:"",autofocus:""},domProps:{value:e.profile.email},on:{input:[function(t){t.target.composing||e.$set(e.profile,"email",t.target.value)},e.$v.profile.email.$touch]}}),!e.$v.profile.email&&e.$v.profile.email.$dirty?a("small",{staticClass:"text-danger"},[e._v("請輸入格式正確的電子信箱")]):e._e(),!e.$v.profile.email.required&&e.$v.profile.email.$dirty?a("small",{staticClass:"text-danger"},[e._v("電子信箱必填")]):e._e()]),a("div",{staticClass:"form-label-group mb-3 col-sm-6 col-12",class:{"form-group--error":e.$v.profile.account.$error}},[a("label",{attrs:{for:"name"}},[e._v("Account")]),a("input",{directives:[{name:"model",rawName:"v-model",value:e.profile.account,expression:"profile.account"}],staticClass:"form-control",attrs:{disabled:e.initialIsProcessing||!e.initialEditing,maxlength:"30",minlength:"6",id:"account",name:"account",type:"text",placeholder:"account",required:""},domProps:{value:e.profile.account},on:{input:[function(t){t.target.composing||e.$set(e.profile,"account",t.target.value)},e.$v.profile.account.$touch]}}),a("small",{directives:[{name:"show",rawName:"v-show",value:e.$v.profile.account.$error,expression:"$v.profile.account.$error"}],staticClass:"text-danger"},[e._v("長度介於 5 - 30")])]),a("div",{staticClass:"col-12 pb-4"},[a("button",{staticClass:"btn btn-primary w-50 p-2",attrs:{disabled:e.initialIsProcessing},on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.$router.back()}}},[e._v("回上一頁")]),a("button",{staticClass:"btn btn-primary w-50 p-2",attrs:{disabled:e.initialIsProcessing||e.$v.$invalid||!e.initialEditing,type:"submit"},on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.handleSubmit(t)}}},[e._v(e._s(e.initialIsProcessing?"處理中...":"送出"))])])])])])},r=[],n=(a("a4d3"),a("99af"),a("4de4"),a("4160"),a("c975"),a("d81d"),a("fb6a"),a("b0c0"),a("e439"),a("dbb4"),a("b64b"),a("d3b7"),a("ac1f"),a("6062"),a("3ca3"),a("841c"),a("159b"),a("ddb0"),a("2b3d"),a("96cf"),a("1da1")),s=a("2909"),o=a("ade3"),l=a("bf8e"),c=a("2708"),u=a("b5ae");function m(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,i)}return a}function p(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?m(Object(a),!0).forEach((function(t){Object(o["a"])(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):m(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var f={name:"ProfileForm",mixins:[c["a"]],props:{initialProfile:{type:Object,default:function(){return{account:"",phone:"",name:"",email:"",avatar:"",preferredTags:[{id:1,name:""}]}}},initialTags:{type:Array,default:function(){return[]}},initialIsProcessing:{type:Boolean,default:!1},initialEditing:{type:Boolean,default:!1}},data:function(){return{profile:this.initialProfile,tags:this.initialTags,tagName:"",tag:"",searchResult:[]}},validations:{profile:{account:{required:u["required"],minLength:Object(u["minLength"])(5),maxLength:Object(u["maxLength"])(30)},phone:{required:u["required"],minLength:Object(u["minLength"])(10),maxLength:Object(u["maxLength"])(10)},name:{required:u["required"],minLength:Object(u["minLength"])(1),maxLength:Object(u["maxLength"])(20)},email:{required:u["required"],email:u["email"]}}},watch:{initialProfile:function(e){this.profile=p({},this.profile,{},e)},initialTags:function(e){this.tags=p({},this.tags,{},e)}},computed:{tagsDisplay:function(){var e=[].concat(Object(s["a"])(this.searchResult),Object(s["a"])(this.initialTags)),t=e.filter((function(e){var t=e.id,a=e.name,i="".concat(t).concat(a);return!this.has(i)&&this.add(i)}),new Set),a=t.slice(0,6);return a}},created:function(){},methods:{edit:function(){this.$emit("after-edit")},searchTag:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(){var t,a,i,r=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,l["a"].search({name:this.tagName});case 3:if(t=e.sent,a=t.data,i=t.statusText,"OK"===i){e.next=7;break}throw new Error(i);case 7:0===a.length&&this.$swal({toast:!0,position:"top",showConfirmButton:!1,timer:3e3,icon:"warning",title:"未找到相關標籤",text:""}),this.searchResult=[],a.map((function(e){r.searchResult.push({id:e.id,name:e.name})})),e.next=15;break;case 12:e.prev=12,e.t0=e["catch"](0),console.log("error",e.t0);case 15:case"end":return e.stop()}}),e,this,[[0,12]])})));function t(){return e.apply(this,arguments)}return t}(),handleFileChange:function(e){var t=e.target.files;if(t.length){var a=window.URL.createObjectURL(t[0]);this.profile.avatar=a}},handleSubmit:function(){this.$emit("after-submit")},addTag:function(e){var t=this.profile.preferredTags.map((function(e){return e.name})).indexOf(e.name);-1===t&&this.profile.preferredTags.unshift(e)},removeTag:function(e){this.profile.preferredTags=this.profile.preferredTags.filter((function(t){return t!==e}))}}},d=f,g=(a("b4c4"),a("2877")),h=Object(g["a"])(d,i,r,!1,null,"187a69ee",null);t["a"]=h.exports},cd5d:function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{},[a("div",{staticStyle:{height:"37px"}}),a("div",{staticClass:"fixed-bottom"},[a("div",{staticClass:"collapse",attrs:{id:"navbarToggleExternalContent"}},[a("div",{staticClass:"p-2 text-center",staticStyle:{"border-radius":"50% 50% 0 0","background-color":"#e3f2fd"}},[a("router-link",{staticClass:"d-block py-2 h4",attrs:{to:{name:"member-profile"}}},[e._v("會員設定")]),a("router-link",{staticClass:"d-block py-2 h4",attrs:{to:{name:"member-password"}}},[e._v("密碼設定")]),a("router-link",{staticClass:"d-block py-2 h4",attrs:{to:{name:"member-my-orders"}}},[e._v("訂餐紀錄")]),a("div",{staticClass:"text-primary py-2 h4",on:{click:e.logout}},[e._v("登出")])],1)]),a("nav",{staticClass:"navbar navbar-light d-flex justify-content-around",staticStyle:{"background-color":"#e3f2fd"}},[a("router-link",{attrs:{to:{name:"member-menu"}}},[e._v("菜單")]),a("router-link",{attrs:{to:{name:"member-order-list"}}},[e._v("結帳")]),a("router-link",{attrs:{to:{name:"member-order-state"}}},[e._v("狀態")]),a("p",{staticClass:"text-primary",attrs:{"data-toggle":"collapse","data-target":"#navbarToggleExternalContent","aria-controls":"navbarToggleExternalContent","aria-expanded":"false","aria-label":"Toggle navigation"}},[e._v("會員")])],1)])])},r=[],n={name:"MemberNavbarBottom",data:function(){return{}},created:function(){},methods:{logout:function(){this.$store.commit("revokeAuthentication"),this.$router.push("/signin")}}},s=n,o=a("2877"),l=Object(o["a"])(s,i,r,!1,null,null,null);t["a"]=l.exports}}]);
//# sourceMappingURL=chunk-0e7d6c9a.0117e3e7.js.map