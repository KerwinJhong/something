(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-b0b071f8"],{2708:function(t,e,r){"use strict";r.d(e,"c",(function(){return i})),r.d(e,"b",(function(){return a})),r.d(e,"a",(function(){return o}));var n=r("c1df"),s=r.n(n),i={filters:{timeFrom:function(t){return t?s()(t).locale("zh-tw").format("llll"):"-"}}},a={filters:{fromNow:function(t){return t?s()(t).fromNow():"-"}}},o={filters:{emptyImage:function(t){return t||"https://via.placeholder.com/350x220/DFDFDF?text=No+Image"}}}},2909:function(t,e,r){"use strict";function n(t){if(Array.isArray(t)){for(var e=0,r=new Array(t.length);e<t.length;e++)r[e]=t[e];return r}}r("a4d3"),r("e01a"),r("d28b"),r("a630"),r("e260"),r("d3b7"),r("25f0"),r("3ca3"),r("ddb0");function s(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}function i(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function a(t){return n(t)||s(t)||i()}r.d(e,"a",(function(){return a}))},"5bba":function(t,e,r){"use strict";var n=r("d61c"),s=r.n(n);s.a},"8c34":function(t,e,r){"use strict";var n=r("d0bb"),s=r.n(n);s.a},a630:function(t,e,r){var n=r("23e7"),s=r("4df4"),i=r("1c7e"),a=!i((function(t){Array.from(t)}));n({target:"Array",stat:!0,forced:a},{from:s})},d0bb:function(t,e,r){},d28b:function(t,e,r){var n=r("746f");n("iterator")},d61c:function(t,e,r){},e01a:function(t,e,r){"use strict";var n=r("23e7"),s=r("83ab"),i=r("da84"),a=r("5135"),o=r("861d"),c=r("9bf2").f,d=r("e893"),u=i.Symbol;if(s&&"function"==typeof u&&(!("description"in u.prototype)||void 0!==u().description)){var l={},f=function(){var t=arguments.length<1||void 0===arguments[0]?void 0:String(arguments[0]),e=this instanceof f?new u(t):void 0===t?u():u(t);return""===t&&(l[e]=!0),e};d(f,u);var h=f.prototype=u.prototype;h.constructor=f;var p=h.toString,m="Symbol(test)"==String(u("test")),v=/^Symbol\((.*)\)[^)]+$/;c(h,"description",{configurable:!0,get:function(){var t=o(this)?this.valueOf():this,e=p.call(t);if(a(l,t))return"";var r=m?e.slice(7,-1):e.replace(v,"$1");return""===r?void 0:r}}),n({global:!0,forced:!0},{Symbol:f})}},e213:function(t,e,r){"use strict";r.r(e);var n=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("AdminNavbarTop",{attrs:{"initial-title":t.title}}),t.isLoading?r("Spinner"):[r("ul",{staticClass:"nav nav-pills"},t._l(t.categories,(function(e){return r("li",{key:e.id,staticClass:"nav-item"},[r("router-link",{staticClass:"nav-link",attrs:{to:{name:"admin-day-orders",query:{state:e.id}}}},[t._v(t._s(e.name))])],1)})),0),r("div",{staticClass:"border border-dark p-0 alist"},[!t.orders.length>0?r("h1",{staticClass:"warningText"},[t._v("Oops!沒有任何訂單，新增一些訂單吧!")]):r("div",[r("AdminDayOrderTable",{attrs:{isProcessing:t.isProcessing,"initial-orders":t.orders,"state-button":t.stateButton},on:{"after-delete-order":t.afterDeleteOrder,"after-order-state-switch":t.afterOrderStateSwitch}})],1)])],r("AdminNavbarBottm")],2)},s=[],i=(r("4de4"),r("b0c0"),r("2909")),a=(r("96cf"),r("1da1")),o=r("a2fe"),c=r("34f8"),d=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{directives:[{name:"masonry",rawName:"v-masonry"}],staticClass:"masonry-container",attrs:{"transition-duration":"1s","item-selector":".item","column-width":"2"}},t._l(t.orders,(function(e){return r("div",{directives:[{name:"masonry-tile",rawName:"v-masonry-tile"}],key:e.id,staticClass:"item bg-white shadow-lg"},[r("table",{staticClass:"table table-striped table-hover mb-0"},[r("thead",[r("tr",[r("th",[r("div",{staticClass:"row"},[r("small",{staticClass:"col"},[t._v(t._s(t._f("fromNow")(e.createdAt)))]),r("h4",{staticClass:"col text-center"},[t._v(t._s(e.flowId))]),"paid"===e.state?r("div",{staticClass:"col"}):t._e(),"paid"!==e.state?r("button",{staticClass:"btn btn-danger col",attrs:{disabled:t.processing},on:{click:function(r){return r.stopPropagation(),r.preventDefault(),t.deleteOrder(e.id)}}},[t._v(t._s(t.processing?"處理中...":"刪除"))]):t._e()])])])]),r("tbody",t._l(e.sumOfDishes,(function(e){return r("tr",{key:e.id},[r("td",[r("div",{staticClass:"d-flex justify-content-between"},[r("h4",{staticClass:"mb-0 d-inline-block"},[t._v(t._s(e.name))]),r("p",{staticClass:"d-inline-block",staticStyle:{"line-height":"2"}},[t._v("數量："+t._s(e.DishCombination.perQuantity))])])])])})),0),r("tfoot",[r("tr",{staticClass:"note"},[r("td",[r("h4",[t._v(t._s(e.memo))]),r("div",{staticClass:"row my-2"},[r("div",{directives:[{name:"show",rawName:"v-show",value:"pending"===e.state,expression:"order.state === `pending`"}],staticClass:"col-4"}),r("button",{directives:[{name:"show",rawName:"v-show",value:"pending"!==e.state,expression:"order.state !== `pending`"}],staticClass:"col-4 btn btn-primary",on:{click:function(r){return r.stopPropagation(),r.preventDefault(),t.stateSwitch("prevState",e.id)}}},[r("svg",{staticStyle:{width:"20px",height:"24px"},attrs:{viewBox:"6 1 20 24"}},[r("path",{attrs:{fill:"#f4f4f4",d:"M15.41,16.58L10.83,12L15.41,7.41L14,6L8,12L14,18L15.41,16.58Z"}})]),t._v(" "+t._s(t.stateBtn.left)+" ")]),r("h4",{staticClass:"col-4 text-center p-0 text-capitalize"},[t._v(t._s(e.state))]),r("button",{directives:[{name:"show",rawName:"v-show",value:"paid"!==e.state,expression:"order.state !== `paid`"}],staticClass:"col-4 btn btn-primary",on:{click:function(r){return r.stopPropagation(),r.preventDefault(),t.stateSwitch("nextState",e.id)}}},[t._v(" "+t._s(t.stateBtn.right)+" "),r("svg",{staticStyle:{width:"20px",height:"24px"},attrs:{viewBox:"0 2 15 24"}},[r("path",{attrs:{fill:"#f4f4f4",d:"M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z"}})])])]),e.isTakingAway?r("h5",{staticClass:"float-left"},[t._v("外帶")]):r("h5",{staticClass:"float-left"},[t._v("桌號："+t._s(e.tableNum))]),r("h5",{staticClass:"float-right"},[t._v("總額："+t._s(e.amount))])])])])])])})),0)},u=[],l=(r("a4d3"),r("4160"),r("e439"),r("dbb4"),r("b64b"),r("159b"),r("ade3")),f=r("2708");function h(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function p(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?h(Object(r),!0).forEach((function(e){Object(l["a"])(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):h(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}var m={mixins:[f["c"],f["b"]],name:"AdminDayOrderTable",props:{isProcessing:{type:Boolean},initialOrders:{type:Array},stateButton:{type:Object}},data:function(){return{orders:this.initialOrders,tableNum:0,isTakingAway:0,memo:"",quantity:0,amount:0,processing:this.isProcessing,stateBtn:this.stateButton}},created:function(){},methods:{stateSwitch:function(t,e){this.$emit("after-order-state-switch",{state:t,orderId:e})},deleteOrder:function(t){this.$emit("after-delete-order",t)}},watch:{initialOrders:function(t){this.orders={},this.orders=p({},this.orders,{},t)},isProcessing:function(t){return this.processing=t},stateButton:function(t){this.stateBtn=p({},this.stateBtn,{},t)}}},v=m,b=(r("8c34"),r("2877")),g=Object(b["a"])(v,d,u,!1,null,"2e169281",null),w=g.exports,y=r("5aa0"),O=r("60c1"),_=r("8055"),x=r.n(_),k={name:"AdminDayOrders",components:{AdminNavbarTop:o["a"],AdminNavbarBottm:c["a"],AdminDayOrderTable:w,Spinner:y["a"]},data:function(){return{title:"當日訂單",categories:[{id:"pending",name:"未製作"},{id:"making",name:"製作中"},{id:"unpaid",name:"未結帳"},{id:"paid",name:"已結帳"}],orders:[],stateButton:{},isProcessing:!1,isLoading:!0,socket:x()("https://recusplatform.herokuapp.com/")}},methods:{fetchOrders:function(){var t=Object(a["a"])(regeneratorRuntime.mark((function t(e){var r,n,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,O["a"].orders.get(e);case 3:if(r=t.sent,n=r.data,s=r.statusText,"OK"===s){t.next=7;break}throw new Error(s);case 7:this.orders=Object(i["a"])(n.orders),"pending"===e.state&&(this.stateButton.left="",this.stateButton.right="製作中"),"making"===e.state&&(this.stateButton.left="未製作",this.stateButton.right="未結帳"),"unpaid"===e.state&&(this.stateButton.left="製作中",this.stateButton.right="已結帳"),"paid"===e.state&&(this.stateButton.left="未結帳",this.stateButton.right=""),this.isLoading=!1,t.next=20;break;case 15:t.prev=15,t.t0=t["catch"](0),this.isLoading=!1,this.$swal({icon:"warning",title:"無法取得資料，請稍後再試"}),console.log("error",t.t0);case 20:case"end":return t.stop()}}),t,this,[[0,15]])})));function e(e){return t.apply(this,arguments)}return e}(),afterDeleteOrder:function(){var t=Object(a["a"])(regeneratorRuntime.mark((function t(e){var r,n,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.isProcessing=!0,t.prev=1,t.next=4,O["a"].orders.delete(e);case 4:if(r=t.sent,n=r.data,s=r.statusText,"OK"===s&&"success"===n.status){t.next=8;break}throw new Error(s);case 8:this.orders=this.orders.filter((function(t){return t.id!==e})),this.$swal({icon:"success",title:n.msg}),this.socket.emit("deleteOrder"),this.isProcessing=!1,t.next=19;break;case 14:t.prev=14,t.t0=t["catch"](1),this.$swal({icon:"warning",title:"無法取得資料，請稍後再試"}),this.isProcessing=!1,console.log("error",t.t0);case 19:case"end":return t.stop()}}),t,this,[[1,14]])})));function e(e){return t.apply(this,arguments)}return e}(),afterOrderStateSwitch:function(){var t=Object(a["a"])(regeneratorRuntime.mark((function t(e){var r,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,O["a"].state.put(e);case 3:if(r=t.sent,r.data,n=r.statusText,"OK"===n){t.next=7;break}throw new Error(n);case 7:this.orders=this.orders.filter((function(t){return t.id!==e.orderId})),this.socket.emit("switchState"),t.next=15;break;case 11:t.prev=11,t.t0=t["catch"](0),this.$swal({icon:"warning",title:"無法取得資料，請稍後再試"}),console.log("error",t.t0);case 15:case"end":return t.stop()}}),t,this,[[0,11]])})));function e(e){return t.apply(this,arguments)}return e}(),afterAddUser:function(t){this.addDishes.user=t.name},aftersubmitorder:function(){this.addDishes={list:[],user:"",quantity:0,amount:0},this.user.name=""}},created:function(){this.socket.emit("init");var t=this.$route.query.state,e=void 0===t?"pending":t;this.fetchOrders({state:e})},beforeRouteUpdate:function(t,e,r){var n=t.query.state,s=void 0===n?"pending":n;this.fetchOrders({state:s}),r()}},C=k,S=(r("5bba"),Object(b["a"])(C,n,s,!1,null,"5a27a58e",null));e["default"]=S.exports}}]);
//# sourceMappingURL=chunk-b0b071f8.0b4fbf77.js.map